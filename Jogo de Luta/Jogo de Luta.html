<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Jogo de Luta</title>
        <script src="Lutador.js"></script>
    </head>
    <body>
        <h1>Jogo de luta</h1>
        <canvas></canvas>
        <script>
            
            var canvas = document.querySelector("canvas");
            canvas.width = 900;
            canvas.height = 500;
            
            var dt = 0;
            var anterior = 0;
            var ctx = canvas.getContext("2d");
            

            var lutador = new Lutador();
            
            var teclas = {
                cima : 0,
                esquerda : 0,
                direita : 0,
                baixo : 0,
                espaco : 0,
                Q : 0,
                W : 0,
                E : 0,
                A : 0,
                S : 0,
                D : 0
            }

            
            function desenhaCenario(){
            ctx.fillStyle = "tan";
            ctx.fillRect(0,0,canvas.width, canvas.height);
            }


            function desenhaChao(){
            ctx.fillStyle = "brown";
            ctx.fillRect(0,canvas.height - 60,canvas.width, canvas.height);
            }

        function passo(t)//Main loop
        {
            dt = (t - anterior)/1000;

            
            desenhaCenario();
            desenhaChao();
         
            lutador.desenhar(ctx);
            lutador.mover(dt);

            lutador.controlePorTeclasDown({teclas : teclas});
            lutador.controlePorTeclasUp({teclas : teclas});

            anterior = t;
            requestAnimationFrame(passo);
        }
        //Jogo


        //Controles
        addEventListener("keydown", function(e){
           // console.log(e.keyCode);
            switch(e.keyCode)
            {
                
                case 37:
                teclas.esquerda = 1;
                break;
                case 38:
                teclas.cima = 1;
                break;
                case 39:
                teclas.direita = 1;
                break;
                case 40:
                teclas.baixo = 1;
                break;
                case 32:
                teclas.espaco = 1;
                break;      
                case 81:
                teclas.Q = 1;
                break;
                case 87:
                teclas.W = 1;
                break;
                case 69:
                teclas.E = 1;
                break;
                case 65:
                teclas.A = 1;
                break;
                case 83:
                teclas.S = 1;
                break;
                case 68:
                teclas.D = 1;
                break;
            }
        })
        addEventListener("keyup", function(e){
            switch(e.keyCode)
            {
                case 37:
                teclas.esquerda = 0;
                break;
                case 38:
                teclas.cima = 0;
                break;
                case 39:
                teclas.direita = 0;
                break;
                case 40:
                teclas.baixo = 0;
                break;
                case 32:
                teclas.espaco = 0;
                break;
                case 81:
                teclas.Q = 0;
                break;
                case 87:
                teclas.W = 0;
                break;
                case 69:
                teclas.E = 0;
                break;
                case 65:
                teclas.A = 0;
                break;
                case 83:
                teclas.S = 0;
                break;
                case 68:
                teclas.D = 0;
                break;
            }
        })
        requestAnimationFrame(passo);

    </script>
    
</body>
</html>